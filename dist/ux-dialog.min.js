/*
 MIT License. 
 ux-dialog v0.1.6
 author: uiwwsw
 homepage:https://github.com/uiwwsw/ux-dialog#readme
 */ "use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var c=t[n];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(e,c.key,c)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var defaultText={confirm:"확인",cancel:"취소"},contentsType={confirm:"boolean",cancel:"boolean",title:"string",content:"string",callback:"function",text:"string",selfClose:"number",closeKey:"number",cancelKey:"number",confirmKey:"number"},UxDialog=function(){function o(e){_classCallCheck(this,o),this.getDefaultContents(e||{})}return _createClass(o,[{key:"checkType",value:function(e){var o=this;Object.entries(e).map(function(e){var t=e[0],n=e[1];if("object"===_typeof(n))o.checkType(n);else{var c=contentsType[t];if(_typeof(n)!==c)throw"".concat(n,"는 ").concat(c,"이 아닙니다.")}})}},{key:"makeNode",value:function(e){var t="",n="";e.confirm&&(t='<button name="confirm" type="button">'.concat(e.confirm.text||defaultText.confirm,"</button>")),e.cancel&&(n='<button name="cancel" type="button">'.concat(e.cancel.text||defaultText.cancel,"</button>"));var c='\n          <div class="ux-dialog">\n            <div class="ux-dialog--content">\n              <button type="button" class="ux-dialog--close">this dialog close</button>\n              <div class="ux-dialog--header">'.concat(e.title,'</div>\n              <div class="ux-dialog--container">').concat(e.content,'</div>\n              <div class="ux-dialog--footer">').concat(t).concat(n,'</div>\n              <i class="ux-dialog--loading"></i>\n            </div>\n            <i class="ux-dialog--dim"></i>\n          </div>\n        ');return o.htmlToElement(c)}},{key:"append",value:function(e){var t=document.body;this.element=this.makeNode(e),t.appendChild(this.element)}},{key:"getDefaultContents",value:function(e){var t=this;this.checkType(e),this.element=null,this.contents={},Object.entries(e).map(function(e){t.contents[e[0]]=e[1]})}},{key:"bindEvent",value:function(t){var n=this;window.onkeyup=function(e){console.log(e.keyCode),t.closeKey===e.keyCode&&n.close(),t.cancelKey&&(t.cancel.callback&&t.cancel.callback(),n.close()),t.confirmKey&&t.confirm.callback&&t.confirm.callback()},this.element.querySelector(".ux-dialog--close").onclick=function(){n.close()},this.element.querySelector(".ux-dialog--footer").onclick=function(e){switch(e.target.name){case"confirm":t.confirm.callback&&t.confirm.callback();break;case"cancel":t.cancel.callback&&t.cancel.callback(),n.close()}}}},{key:"open",value:function(e){var c=this;if(null===this.element){var o=Object.assign({},this.contents);e&&(this.checkType(e),Object.entries(e).map(function(e){var t=e[0],n=e[1];c.contents[t]!==n&&(o[t]=n)})),this.append(o),this.bindEvent(o),o.selfClose&&(clearTimeout(this.sto),this.element.querySelector(".ux-dialog--loading").style.animationDuration=o.selfClose/1e3+"s",this.sto=setTimeout(function(){c.close()},o.selfClose))}}},{key:"close",value:function(){var e=this.element;e&&(e.classList.add("close"),e.querySelector(".ux-dialog--dim").addEventListener("animationend",function(){e.remove()}),this.element=null)}}],[{key:"htmlToElement",value:function(e){var t=document.createElement("template");return e=e.trim(),t.innerHTML=e,t.content.firstChild}}]),o}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIl0sIm5hbWVzIjpbImRlZmF1bHRUZXh0IiwiY29uZmlybSIsImNhbmNlbCIsImNvbnRlbnRzVHlwZSIsInRpdGxlIiwiY29udGVudCIsImNhbGxiYWNrIiwidGV4dCIsInNlbGZDbG9zZSIsImNsb3NlS2V5IiwiY2FuY2VsS2V5IiwiY29uZmlybUtleSIsIlV4RGlhbG9nIiwiY29udGVudHMiLCJfY2xhc3NDYWxsQ2hlY2siLCJ0aGlzIiwiZ2V0RGVmYXVsdENvbnRlbnRzIiwib2JqZWN0IiwiX3RoaXMiLCJPYmplY3QiLCJlbnRyaWVzIiwibWFwIiwidmFsIiwia2V5IiwidmFsdWUiLCJfdHlwZW9mIiwiY2hlY2tUeXBlIiwidHlwZSIsImNvbmNhdCIsImRpYWxvZyIsImh0bWxUb0VsZW1lbnQiLCJib2R5IiwiZG9jdW1lbnQiLCJlbGVtZW50IiwibWFrZU5vZGUiLCJhcHBlbmRDaGlsZCIsIl90aGlzMiIsIl90aGlzMyIsIndpbmRvdyIsIm9ua2V5dXAiLCJlIiwiY29uc29sZSIsImxvZyIsImtleUNvZGUiLCJjbG9zZSIsInF1ZXJ5U2VsZWN0b3IiLCJvbmNsaWNrIiwidGFyZ2V0IiwibmFtZSIsIl90aGlzNCIsIm9uY2UiLCJhc3NpZ24iLCJhcHBlbmQiLCJiaW5kRXZlbnQiLCJjbGVhclRpbWVvdXQiLCJzdG8iLCJzdHlsZSIsImFuaW1hdGlvbkR1cmF0aW9uIiwic2V0VGltZW91dCIsImNsYXNzTGlzdCIsImFkZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmUiLCJzdHIiLCJ0ZW1wbGF0ZSIsImNyZWF0ZUVsZW1lbnQiLCJ0cmltIiwiaW5uZXJIVE1MIiwiZmlyc3RDaGlsZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7d29CQWdCQSxJQUFNQSxZQUFjLENBQ2hCQyxRQUFTLEtBQ1RDLE9BQVEsTUFHTkMsYUFBZSxDQUNqQkYsUUFBUyxVQUNUQyxPQUFRLFVBQ1JFLE1BQU8sU0FDUEMsUUFBUyxTQUNUQyxTQUFVLFdBQ1ZDLEtBQU0sU0FD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TCxTQUNOTSxFQUFLMUMsNkNBTWhCLElBQU15QixFQUFVbEIsS0FBS2tCLFFBQ2pCQSxJQUNBQSxFQUFRMEIsVUFBVUMsSUFBSSxTQUN0QjNCLEVBQVFZLGNBQWMsbUJBQW1CZ0IsaUJBQWlCLGVBQWdCLFdBQ3RFNUIsRUFBUTZCLFdBRVovQyxLQUFLa0IsUUFBVSw4Q0F0RkY4QixHQUNqQixJQUFNQyxFQUFXaEMsU0FBU2lDLGNBQWMsWUFHeEMsT0FGQUYsRUFBTUEsRUFBSUcsT0FDVkYsRUFBU0csVUFBWUosRUFDZEMsRUFBUzNELFFBQVErRCIsImZpbGUiOiJ1eC1kaWFsb2cubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW50ZXJmYWNlIEJ1dHRvbiB7XHJcbiAgICBjYWxsYmFjaz86IEZ1bmN0aW9uO1xyXG4gICAgdGV4dD86IHN0cmluZztcclxufVxyXG5cclxuaW50ZXJmYWNlIENvbnRlbnRzIHtcclxuICAgIHRpdGxlPzogc3RyaW5nO1xyXG4gICAgY29udGVudD86IHN0cmluZyB8IE5vZGU7XHJcbiAgICBjb25maXJtPzogQnV0dG9uIHwgbnVsbDtcclxuICAgIGNhbmNlbD86IEJ1dHRvbiB8IG51bGw7XHJcbiAgICBzZWxmQ2xvc2U/OiBudW1iZXI7XHJcbiAgICBjbG9zZUtleT86IG51bWJlcjtcclxuICAgIGNhbmNlbEtleT86IG51bWJlcjtcclxuICAgIGNvbmZpcm1LZXk/OiBudW1iZXI7XHJcbn1cclxuXHJcbmNvbnN0IGRlZmF1bHRUZXh0ID0ge1xyXG4gICAgY29uZmlybTogJ+2ZleyduCcsXHJcbiAgICBjYW5jZWw6ICfst6jshownXHJcbn07XHJcblxyXG5jb25zdCBjb250ZW50c1R5cGUgPSB7XHJcbiAgICBjb25maXJtOiAnYm9vbGVhbicsXHJcbiAgICBjYW5jZWw6ICdib29sZWFuJyxcclxuICAgIHRpdGxlOiAnc3RyaW5nJyxcclxuICAgIGNvbnRlbnQ6ICdzdHJpbmcnLFxyXG4gICAgY2FsbGJhY2s6ICdmdW5jdGlvbicsXHJcbiAgICB0ZXh0OiAnc3RyaW5nJyxcclxuICAgIHNlbGZDbG9zZTogJ251bWJlcicsXHJcbiAgICBjbG9zZUtleTogJ251bWJlcicsXHJcbiAgICBjYW5jZWxLZXk6ICdudW1iZXInLFxyXG4gICAgY29uZmlybUtleTogJ251bWJlcidcclxufTtcclxuXHJcbmNsYXNzIFV4RGlhbG9nIHtcclxuICAgIHByaXZhdGUgc3RvOiBhbnk7XHJcbiAgICBwcml2YXRlIGVsZW1lbnQ6IGFueTtcclxuICAgIHByaXZhdGUgY29udGVudHM6IENvbnRlbnRzO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGNvbnRlbnRzOiBDb250ZW50cykge1xyXG4gICAgICAgIHRoaXMuZ2V0RGVmYXVsdENvbnRlbnRzKGNvbnRlbnRzIHx8IHt9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNoZWNrVHlwZShvYmplY3Q6IG9iamVjdCk6IHZvaWQge1xyXG4gICAgICAgIE9iamVjdC5lbnRyaWVzKG9iamVjdCkubWFwKCh2YWwpID0+IHtcclxuICAgICAgICAgICAgY29uc3Qga2V5ID0gdmFsWzBdO1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHZhbFsxXTtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tUeXBlKHZhbHVlKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBjb250ZW50c1R5cGVba2V5XTtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09IHR5cGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBgJHt2YWx1ZX3ripQgJHt0eXBlfeydtCDslYTri5nri4jri6QuYFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBtYWtlTm9kZShjb250ZW50czogQ29udGVudHMpOiBhbnkge1xyXG4gICAgICAgIGxldCBjb25maXJtID0gJyc7XHJcbiAgICAgICAgbGV0IGNhbmNlbCA9ICcnO1xyXG4gICAgICAgIGlmIChjb250ZW50cy5jb25maXJtKSB7XHJcbiAgICAgICAgICAgIGNvbmZpcm0gPSBgPGJ1dHRvbiBuYW1lPVwiY29uZmlybVwiIHR5cGU9XCJidXR0b25cIj4ke2NvbnRlbnRzLmNvbmZpcm0udGV4dCB8fCBkZWZhdWx0VGV4dC5jb25maXJtfTwvYnV0dG9uPmBcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNvbnRlbnRzLmNhbmNlbCkge1xyXG4gICAgICAgICAgICBjYW5jZWwgPSBgPGJ1dHRvbiBuYW1lPVwiY2FuY2VsXCIgdHlwZT1cImJ1dHRvblwiPiR7Y29udGVudHMuY2FuY2VsLnRleHQgfHwgZGVmYXVsdFRleHQuY2FuY2VsfTwvYnV0dG9uPmBcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZGlhbG9nID0gYFxyXG4gICAgICAgICAgPGRpdiBjbGFzcz1cInV4LWRpYWxvZ1wiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwidXgtZGlhbG9nLS1jb250ZW50XCI+XHJcbiAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJ1eC1kaWFsb2ctLWNsb3NlXCI+dGhpcyBkaWFsb2cgY2xvc2U8L2J1dHRvbj5cclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidXgtZGlhbG9nLS1oZWFkZXJcIj4ke2NvbnRlbnRzLnRpdGxlfTwvZGl2PlxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ1eC1kaWFsb2ctLWNvbnRhaW5lclwiPiR7Y29udGVudHMuY29udGVudH08L2Rpdj5cclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidXgtZGlhbG9nLS1mb290ZXJcIj4ke2NvbmZpcm19JHtjYW5jZWx9PC9kaXY+XHJcbiAgICAgICAgICAgICAgPGkgY2xhc3M9XCJ1eC1kaWFsb2ctLWxvYWRpbmdcIj48L2k+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8aSBjbGFzcz1cInV4LWRpYWxvZy0tZGltXCI+PC9pPlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgYDtcclxuICAgICAgICByZXR1cm4gVXhEaWFsb2cuaHRtbFRvRWxlbWVudChkaWFsb2cpO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBodG1sVG9FbGVtZW50KHN0cjogc3RyaW5nKTogYW55IHtcclxuICAgICAgICBjb25zdCB0ZW1wbGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RlbXBsYXRlJyk7XHJcbiAgICAgICAgc3RyID0gc3RyLnRyaW0oKTtcclxuICAgICAgICB0ZW1wbGF0ZS5pbm5lckhUTUwgPSBzdHI7XHJcbiAgICAgICAgcmV0dXJuIHRlbXBsYXRlLmNvbnRlbnQuZmlyc3RDaGlsZDtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGFwcGVuZChjb250ZW50czogQ29udGVudHMpIHtcclxuICAgICAgICBjb25zdCBib2R5ID0gZG9jdW1lbnQuYm9keTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQgPSB0aGlzLm1ha2VOb2RlKGNvbnRlbnRzKTtcclxuICAgICAgICBib2R5LmFwcGVuZENoaWxkKHRoaXMuZWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXREZWZhdWx0Q29udGVudHMoY29udGVudHM6IENvbnRlbnRzKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5jaGVja1R5cGUoY29udGVudHMpO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jb250ZW50cyA9IHt9O1xyXG4gICAgICAgIE9iamVjdC5lbnRyaWVzKGNvbnRlbnRzKS5tYXAoKHZhbCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRzW3ZhbFswXV0gPSB2YWxbMV07XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBiaW5kRXZlbnQoY29udGVudHM/OiBDb250ZW50cykge1xyXG4gICAgICAgIHdpbmRvdy5vbmtleXVwID0gZSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGUua2V5Q29kZSk7XHJcbiAgICAgICAgICAgIGlmIChjb250ZW50cy5jbG9zZUtleSA9PT0gZS5rZXlDb2RlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGNvbnRlbnRzLmNhbmNlbEtleSkge1xyXG4gICAgICAgICAgICAgICAgKGNvbnRlbnRzLmNhbmNlbC5jYWxsYmFjaykgJiYgKGNvbnRlbnRzLmNhbmNlbC5jYWxsYmFjaygpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY29udGVudHMuY29uZmlybUtleSkge1xyXG4gICAgICAgICAgICAgICAgKGNvbnRlbnRzLmNvbmZpcm0uY2FsbGJhY2spICYmIChjb250ZW50cy5jb25maXJtLmNhbGxiYWNrKCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignLnV4LWRpYWxvZy0tY2xvc2UnKS5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignLnV4LWRpYWxvZy0tZm9vdGVyJykub25jbGljayA9IChlKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBlLnRhcmdldC5uYW1lO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG5hbWUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2NvbmZpcm0nOlxyXG4gICAgICAgICAgICAgICAgICAgIChjb250ZW50cy5jb25maXJtLmNhbGxiYWNrKSAmJiAoY29udGVudHMuY29uZmlybS5jYWxsYmFjaygpKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2NhbmNlbCc6XHJcbiAgICAgICAgICAgICAgICAgICAgKGNvbnRlbnRzLmNhbmNlbC5jYWxsYmFjaykgJiYgKGNvbnRlbnRzLmNhbmNlbC5jYWxsYmFjaygpKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG9wZW4oY29udGVudHM/OiBDb250ZW50cyk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnQgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgbGV0IG9uY2U6IENvbnRlbnRzID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5jb250ZW50cyk7XHJcbiAgICAgICAgICAgIGlmIChjb250ZW50cykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGVja1R5cGUoY29udGVudHMpO1xyXG4gICAgICAgICAgICAgICAgT2JqZWN0LmVudHJpZXMoY29udGVudHMpLm1hcCgodmFsKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5ID0gdmFsWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gdmFsWzFdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbnRlbnRzW2tleV0gIT09IHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uY2Vba2V5XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuYXBwZW5kKG9uY2UpO1xyXG4gICAgICAgICAgICB0aGlzLmJpbmRFdmVudChvbmNlKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChvbmNlLnNlbGZDbG9zZSkge1xyXG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuc3RvKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcudXgtZGlhbG9nLS1sb2FkaW5nJykuc3R5bGUuYW5pbWF0aW9uRHVyYXRpb24gPSBvbmNlLnNlbGZDbG9zZSAvIDEwMDAgKyAncyc7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0byA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgIH0sIG9uY2Uuc2VsZkNsb3NlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY2xvc2UoKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IHRoaXMuZWxlbWVudDtcclxuICAgICAgICBpZiAoZWxlbWVudCkge1xyXG4gICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2Nsb3NlJyk7XHJcbiAgICAgICAgICAgIGVsZW1lbnQucXVlcnlTZWxlY3RvcignLnV4LWRpYWxvZy0tZGltJykuYWRkRXZlbnRMaXN0ZW5lcignYW5pbWF0aW9uZW5kJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5yZW1vdmUoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG4iXX0=
