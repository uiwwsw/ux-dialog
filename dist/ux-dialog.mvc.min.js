/*
 MIT License. 
 ux-dialog v0.1.7
 author: uiwwsw
 homepage:https://github.com/uiwwsw/ux-dialog#readme
 */ "use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var defaultText={confirm:"확인",cancel:"취소"},contentsType={confirm:"boolean",cancel:"boolean",title:"string",content:"string",callback:"function",text:"string",selfClose:"number",closeKey:"number",cancelKey:"number",confirmKey:"number"},UxDialog=function(){function c(e){_classCallCheck(this,c),this.getDefaultContents(e||{})}return _createClass(c,[{key:"checkType",value:function(e){var c=this;Object.entries(e).map(function(e){var t=e[0],n=e[1];if("object"===_typeof(n))c.checkType(n);else{var o=contentsType[t];if(_typeof(n)!==o)throw"".concat(n,"는 ").concat(o,"이 아닙니다.")}})}},{key:"makeNode",value:function(e){var t="",n="";e.confirm&&(t='<button name="confirm" type="button">'.concat(e.confirm.text||defaultText.confirm,"</button>")),e.cancel&&(n='<button name="cancel" type="button">'.concat(e.cancel.text||defaultText.cancel,"</button>"));var o='\n          <div class="ux-dialog">\n            <div class="ux-dialog--content">\n              <button type="button" class="ux-dialog--close">this dialog close</button>\n              <div class="ux-dialog--header">'.concat(e.title,'</div>\n              <div class="ux-dialog--container">').concat(e.content,'</div>\n              <div class="ux-dialog--footer">').concat(t).concat(n,'</div>\n              <i class="ux-dialog--loading"></i>\n            </div>\n            <i class="ux-dialog--dim"></i>\n          </div>\n        ');return c.htmlToElement(o)}},{key:"append",value:function(e){var t=document.body;this.element=this.makeNode(e),t.appendChild(this.element)}},{key:"getDefaultContents",value:function(e){var t=this;this.checkType(e),this.element=null,this.contents={},Object.entries(e).map(function(e){t.contents[e[0]]=e[1]})}},{key:"bindEvent",value:function(t){var n=this;window.onkeyup=function(e){if(t.closeKey!==e.keyCode)return t.cancelKey===e.keyCode?(t.cancel.callback&&t.cancel.callback(),void n.close()):void(t.confirmKey!==e.keyCode||t.confirm.callback&&t.confirm.callback());n.close()},this.element.querySelector(".ux-dialog--close").onclick=function(){n.close()},this.element.querySelector(".ux-dialog--footer").onclick=function(e){switch(e.target.name){case"confirm":t.confirm.callback&&t.confirm.callback();break;case"cancel":t.cancel.callback&&t.cancel.callback(),n.close()}}}},{key:"open",value:function(e){var o=this;if(null===this.element){var c=Object.assign({},this.contents);e&&(this.checkType(e),Object.entries(e).map(function(e){var t=e[0],n=e[1];o.contents[t]!==n&&(c[t]=n)})),this.append(c),this.bindEvent(c),c.selfClose&&(clearTimeout(this.sto),this.element.querySelector(".ux-dialog--loading").style.animationDuration=c.selfClose/1e3+"s",this.sto=setTimeout(function(){o.close()},c.selfClose))}}},{key:"close",value:function(){var e=this.element;e&&(e.classList.add("close"),e.querySelector(".ux-dialog--dim").addEventListener("animationend",function(){e.remove()}),this.element=null)}}],[{key:"htmlToElement",value:function(e){var t=document.createElement("template");return e=e.trim(),t.innerHTML=e,t.content.firstChild}}]),c}(),_default=UxDialog;exports.default=_default;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIiwidXgtZGlhbG9nLmJhc2UuanMiXSwibmFtZXMiOlsiZGVmYXVsdFRleHQiLCJjb25maXJtIiwiY2FuY2VsIiwiY29udGVudHNUeXBlIiwidGl0bGUiLCJjb250ZW50IiwiY2FsbGJhY2siLCJ0ZXh0Iiwic2VsZkNsb3NlIiwiY2xvc2VLZXkiLCJjYW5jZWxLZXkiLCJjb25maXJtS2V5IiwiVXhEaWFsb2ciLCJjb250ZW50cyIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJnZXREZWZhdWx0Q29udGVudHMiLCJvYmplY3QiLCJfdGhpcyIsIk9iamVjdCIsImVudHJpZXMiLCJtYXAiLCJ2YWwiLCJrZXkiLCJ2YWx1ZSIsIl90eXBlb2YiLCJjaGVja1R5cGUiLCJ0eXBlIiwiY29uY2F0IiwiZGlhbG9nIiwiaHRtbFRvRWxlbWVudCIsImJvZHkiLCJkb2N1bWVudCIsImVsZW1lbnQiLCJtYWtlTm9kZSIsImFwcGVuZENoaWxkIiwiX3RoaXMyIiwiX3RoaXMzIiwid2luZG93Iiwib25rZXl1cCIsImUiLCJrZXlDb2RlIiwiY2xvc2UiLCJxdWVyeVNlbGVjdG9yIiwib25jbGljayIsInRhcmdldCIsIm5hbWUiLCJfdGhpczQiLCJvbmNlIiwiYXNzaWduIiwiYXBwZW5kIiwiYmluZEV2ZW50IiwiY2xlYXJUaW1lb3V0Iiwic3RvIiwic3R5bGUiLCJhbmltYXRpb25EdXJhdGlvbiIsInNldFRpbWVvdXQiLCJjbGFzc0xpc3QiLCJhZGQiLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlIiwic3RyIiwidGVtcGxhdGUiLCJjcmVhdGVFbGVtZW50IiwidHJpbSIsImlubmVySFRNTCIsImZpcnN0Q2hpbGQiXSwibWFwcGluZ3MiOiI7Ozs7O3N0QkFnQkEsSUFBTUEsWUFBYyxDQUNoQkMsUUFBUyxLQUNUQyxPQUFRLE1BR05DLGFBQWUsQ0FDakJGLFFBQVMsVUFDVEMsT0FBUSxVQUNSRSxNQUFPLFNBQ1BDLFFBQVMsU0FDVEMsU0FBVSxXQUNWQyxLQUFN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LElBQU1HLFdBQVcsV0FDbEJULEVBQUtMLFNBQ05NLEVBQUt4Qyw2Q0FNaEIsSUFBTXlCLEVBQVVsQixLQUFLa0IsUUFDakJBLElBQ0FBLEVBQVF3QixVQUFVQyxJQUFJLFNBQ3RCekIsRUFBUVUsY0FBYyxtQkFBbUJnQixpQkFBaUIsZUFBZ0IsV0FDdEUxQixFQUFRMkIsV0FFWjdDLEtBQUtrQixRQUFVLDhDQXhGRjRCLEdBQ2pCLElBQU1DLEVBQVc5QixTQUFTK0IsY0FBYyxZQUd4QyxPQUZBRixFQUFNQSxFQUFJRyxPQUNWRixFQUFTRyxVQUFZSixFQUNkQyxFQUFTekQsUUFBUTZELDZCQzJEakJ0RCIsImZpbGUiOiJ1eC1kaWFsb2cubXZjLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImludGVyZmFjZSBCdXR0b24ge1xyXG4gICAgY2FsbGJhY2s/OiBGdW5jdGlvbjtcclxuICAgIHRleHQ/OiBzdHJpbmc7XHJcbn1cclxuXHJcbmludGVyZmFjZSBDb250ZW50cyB7XHJcbiAgICB0aXRsZT86IHN0cmluZztcclxuICAgIGNvbnRlbnQ/OiBzdHJpbmcgfCBOb2RlO1xyXG4gICAgY29uZmlybT86IEJ1dHRvbiB8IG51bGw7XHJcbiAgICBjYW5jZWw/OiBCdXR0b24gfCBudWxsO1xyXG4gICAgc2VsZkNsb3NlPzogbnVtYmVyO1xyXG4gICAgY2xvc2VLZXk/OiBudW1iZXI7XHJcbiAgICBjYW5jZWxLZXk/OiBudW1iZXI7XHJcbiAgICBjb25maXJtS2V5PzogbnVtYmVyO1xyXG59XHJcblxyXG5jb25zdCBkZWZhdWx0VGV4dCA9IHtcclxuICAgIGNvbmZpcm06ICftmZXsnbgnLFxyXG4gICAgY2FuY2VsOiAn7Leo7IaMJ1xyXG59O1xyXG5cclxuY29uc3QgY29udGVudHNUeXBlID0ge1xyXG4gICAgY29uZmlybTogJ2Jvb2xlYW4nLFxyXG4gICAgY2FuY2VsOiAnYm9vbGVhbicsXHJcbiAgICB0aXRsZTogJ3N0cmluZycsXHJcbiAgICBjb250ZW50OiAnc3RyaW5nJyxcclxuICAgIGNhbGxiYWNrOiAnZnVuY3Rpb24nLFxyXG4gICAgdGV4dDogJ3N0cmluZycsXHJcbiAgICBzZWxmQ2xvc2U6ICdudW1iZXInLFxyXG4gICAgY2xvc2VLZXk6ICdudW1iZXInLFxyXG4gICAgY2FuY2VsS2V5OiAnbnVtYmVyJyxcclxuICAgIGNvbmZpcm1LZXk6ICdudW1iZXInXHJcbn07XHJcblxyXG5jbGFzcyBVeERpYWxvZyB7XHJcbiAgICBwcml2YXRlIHN0bzogYW55O1xyXG4gICAgcHJpdmF0ZSBlbGVtZW50OiBhbnk7XHJcbiAgICBwcml2YXRlIGNvbnRlbnRzOiBDb250ZW50cztcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihjb250ZW50czogQ29udGVudHMpIHtcclxuICAgICAgICB0aGlzLmdldERlZmF1bHRDb250ZW50cyhjb250ZW50cyB8fCB7fSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjaGVja1R5cGUob2JqZWN0OiBvYmplY3QpOiB2b2lkIHtcclxuICAgICAgICBPYmplY3QuZW50cmllcyhvYmplY3QpLm1hcCgodmFsKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGtleSA9IHZhbFswXTtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSB2YWxbMV07XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrVHlwZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eXBlID0gY29udGVudHNUeXBlW2tleV07XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSB0eXBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgYCR7dmFsdWV964qUICR7dHlwZX3snbQg7JWE64uZ64uI64ukLmBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgbWFrZU5vZGUoY29udGVudHM6IENvbnRlbnRzKTogYW55IHtcclxuICAgICAgICBsZXQgY29uZmlybSA9ICcnO1xyXG4gICAgICAgIGxldCBjYW5jZWwgPSAnJztcclxuICAgICAgICBpZiAoY29udGVudHMuY29uZmlybSkge1xyXG4gICAgICAgICAgICBjb25maXJtID0gYDxidXR0b24gbmFtZT1cImNvbmZpcm1cIiB0eXBlPVwiYnV0dG9uXCI+JHtjb250ZW50cy5jb25maXJtLnRleHQgfHwgZGVmYXVsdFRleHQuY29uZmlybX08L2J1dHRvbj5gXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjb250ZW50cy5jYW5jZWwpIHtcclxuICAgICAgICAgICAgY2FuY2VsID0gYDxidXR0b24gbmFtZT1cImNhbmNlbFwiIHR5cGU9XCJidXR0b25cIj4ke2NvbnRlbnRzLmNhbmNlbC50ZXh0IHx8IGRlZmF1bHRUZXh0LmNhbmNlbH08L2J1dHRvbj5gXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGRpYWxvZyA9IGBcclxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJ1eC1kaWFsb2dcIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInV4LWRpYWxvZy0tY29udGVudFwiPlxyXG4gICAgICAgICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwidXgtZGlhbG9nLS1jbG9zZVwiPnRoaXMgZGlhbG9nIGNsb3NlPC9idXR0b24+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInV4LWRpYWxvZy0taGVhZGVyXCI+JHtjb250ZW50cy50aXRsZX08L2Rpdj5cclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidXgtZGlhbG9nLS1jb250YWluZXJcIj4ke2NvbnRlbnRzLmNvbnRlbnR9PC9kaXY+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInV4LWRpYWxvZy0tZm9vdGVyXCI+JHtjb25maXJtfSR7Y2FuY2VsfTwvZGl2PlxyXG4gICAgICAgICAgICAgIDxpIGNsYXNzPVwidXgtZGlhbG9nLS1sb2FkaW5nXCI+PC9pPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPGkgY2xhc3M9XCJ1eC1kaWFsb2ctLWRpbVwiPjwvaT5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIGA7XHJcbiAgICAgICAgcmV0dXJuIFV4RGlhbG9nLmh0bWxUb0VsZW1lbnQoZGlhbG9nKTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgaHRtbFRvRWxlbWVudChzdHI6IHN0cmluZyk6IGFueSB7XHJcbiAgICAgICAgY29uc3QgdGVtcGxhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZW1wbGF0ZScpO1xyXG4gICAgICAgIHN0ciA9IHN0ci50cmltKCk7XHJcbiAgICAgICAgdGVtcGxhdGUuaW5uZXJIVE1MID0gc3RyO1xyXG4gICAgICAgIHJldHVybiB0ZW1wbGF0ZS5jb250ZW50LmZpcnN0Q2hpbGQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBhcHBlbmQoY29udGVudHM6IENvbnRlbnRzKSB7XHJcbiAgICAgICAgY29uc3QgYm9keSA9IGRvY3VtZW50LmJvZHk7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gdGhpcy5tYWtlTm9kZShjb250ZW50cyk7XHJcbiAgICAgICAgYm9keS5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0RGVmYXVsdENvbnRlbnRzKGNvbnRlbnRzOiBDb250ZW50cyk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuY2hlY2tUeXBlKGNvbnRlbnRzKTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuY29udGVudHMgPSB7fTtcclxuICAgICAgICBPYmplY3QuZW50cmllcyhjb250ZW50cykubWFwKCh2YWwpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jb250ZW50c1t2YWxbMF1dID0gdmFsWzFdO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYmluZEV2ZW50KGNvbnRlbnRzPzogQ29udGVudHMpIHtcclxuICAgICAgICB3aW5kb3cub25rZXl1cCA9IGUgPT4ge1xyXG4gICAgICAgICAgICBpZiAoY29udGVudHMuY2xvc2VLZXkgPT09IGUua2V5Q29kZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjb250ZW50cy5jYW5jZWxLZXkgPT09IGUua2V5Q29kZSkge1xyXG4gICAgICAgICAgICAgICAgKGNvbnRlbnRzLmNhbmNlbC5jYWxsYmFjaykgJiYgKGNvbnRlbnRzLmNhbmNlbC5jYWxsYmFjaygpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY29udGVudHMuY29uZmlybUtleSAgPT09IGUua2V5Q29kZSkge1xyXG4gICAgICAgICAgICAgICAgKGNvbnRlbnRzLmNvbmZpcm0uY2FsbGJhY2spICYmIChjb250ZW50cy5jb25maXJtLmNhbGxiYWNrKCkpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignLnV4LWRpYWxvZy0tY2xvc2UnKS5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignLnV4LWRpYWxvZy0tZm9vdGVyJykub25jbGljayA9IChlKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBlLnRhcmdldC5uYW1lO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG5hbWUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2NvbmZpcm0nOlxyXG4gICAgICAgICAgICAgICAgICAgIChjb250ZW50cy5jb25maXJtLmNhbGxiYWNrKSAmJiAoY29udGVudHMuY29uZmlybS5jYWxsYmFjaygpKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2NhbmNlbCc6XHJcbiAgICAgICAgICAgICAgICAgICAgKGNvbnRlbnRzLmNhbmNlbC5jYWxsYmFjaykgJiYgKGNvbnRlbnRzLmNhbmNlbC5jYWxsYmFjaygpKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG9wZW4oY29udGVudHM/OiBDb250ZW50cyk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnQgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgbGV0IG9uY2U6IENvbnRlbnRzID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5jb250ZW50cyk7XHJcbiAgICAgICAgICAgIGlmIChjb250ZW50cykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGVja1R5cGUoY29udGVudHMpO1xyXG4gICAgICAgICAgICAgICAgT2JqZWN0LmVudHJpZXMoY29udGVudHMpLm1hcCgodmFsKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5ID0gdmFsWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gdmFsWzFdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbnRlbnRzW2tleV0gIT09IHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uY2Vba2V5XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuYXBwZW5kKG9uY2UpO1xyXG4gICAgICAgICAgICB0aGlzLmJpbmRFdmVudChvbmNlKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChvbmNlLnNlbGZDbG9zZSkge1xyXG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuc3RvKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcudXgtZGlhbG9nLS1sb2FkaW5nJykuc3R5bGUuYW5pbWF0aW9uRHVyYXRpb24gPSBvbmNlLnNlbGZDbG9zZSAvIDEwMDAgKyAncyc7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0byA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgIH0sIG9uY2Uuc2VsZkNsb3NlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY2xvc2UoKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IHRoaXMuZWxlbWVudDtcclxuICAgICAgICBpZiAoZWxlbWVudCkge1xyXG4gICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2Nsb3NlJyk7XHJcbiAgICAgICAgICAgIGVsZW1lbnQucXVlcnlTZWxlY3RvcignLnV4LWRpYWxvZy0tZGltJykuYWRkRXZlbnRMaXN0ZW5lcignYW5pbWF0aW9uZW5kJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5yZW1vdmUoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG4iLCJjb25zdCBkZWZhdWx0VGV4dCA9IHtcbiAgICBjb25maXJtOiAn7ZmV7J24JyxcbiAgICBjYW5jZWw6ICfst6jshownXG59O1xuY29uc3QgY29udGVudHNUeXBlID0ge1xuICAgIGNvbmZpcm06ICdib29sZWFuJyxcbiAgICBjYW5jZWw6ICdib29sZWFuJyxcbiAgICB0aXRsZTogJ3N0cmluZycsXG4gICAgY29udGVudDogJ3N0cmluZycsXG4gICAgY2FsbGJhY2s6ICdmdW5jdGlvbicsXG4gICAgdGV4dDogJ3N0cmluZycsXG4gICAgc2VsZkNsb3NlOiAnbnVtYmVyJyxcbiAgICBjbG9zZUtleTogJ251bWJlcicsXG4gICAgY2FuY2VsS2V5OiAnbnVtYmVyJyxcbiAgICBjb25maXJtS2V5OiAnbnVtYmVyJ1xufTtcbmNsYXNzIFV4RGlhbG9nIHtcbiAgICBjb25zdHJ1Y3Rvcihjb250ZW50cykge1xuICAgICAgICB0aGlzLmdldERlZmF1bHRDb250ZW50cyhjb250ZW50cyB8fCB7fSk7XG4gICAgfVxuICAgIGNoZWNrVHlwZShvYmplY3QpIHtcbiAgICAgICAgT2JqZWN0LmVudHJpZXMob2JqZWN0KS5tYXAoKHZhbCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qga2V5ID0gdmFsWzBdO1xuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSB2YWxbMV07XG4gICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tUeXBlKHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBjb250ZW50c1R5cGVba2V5XTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSB0eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IGAke3ZhbHVlfeuKlCAke3R5cGV97J20IOyVhOuLmeuLiOuLpC5gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIG1ha2VOb2RlKGNvbnRlbnRzKSB7XG4gICAgICAgIGxldCBjb25maXJtID0gJyc7XG4gICAgICAgIGxldCBjYW5jZWwgPSAnJztcbiAgICAgICAgaWYgKGNvbnRlbnRzLmNvbmZpcm0pIHtcbiAgICAgICAgICAgIGNvbmZpcm0gPSBgPGJ1dHRvbiBuYW1lPVwiY29uZmlybVwiIHR5cGU9XCJidXR0b25cIj4ke2NvbnRlbnRzLmNvbmZpcm0udGV4dCB8fCBkZWZhdWx0VGV4dC5jb25maXJtfTwvYnV0dG9uPmA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbnRlbnRzLmNhbmNlbCkge1xuICAgICAgICAgICAgY2FuY2VsID0gYDxidXR0b24gbmFtZT1cImNhbmNlbFwiIHR5cGU9XCJidXR0b25cIj4ke2NvbnRlbnRzLmNhbmNlbC50ZXh0IHx8IGRlZmF1bHRUZXh0LmNhbmNlbH08L2J1dHRvbj5gO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRpYWxvZyA9IGBcclxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJ1eC1kaWFsb2dcIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInV4LWRpYWxvZy0tY29udGVudFwiPlxyXG4gICAgICAgICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwidXgtZGlhbG9nLS1jbG9zZVwiPnRoaXMgZGlhbG9nIGNsb3NlPC9idXR0b24+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInV4LWRpYWxvZy0taGVhZGVyXCI+JHtjb250ZW50cy50aXRsZX08L2Rpdj5cclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidXgtZGlhbG9nLS1jb250YWluZXJcIj4ke2NvbnRlbnRzLmNvbnRlbnR9PC9kaXY+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInV4LWRpYWxvZy0tZm9vdGVyXCI+JHtjb25maXJtfSR7Y2FuY2VsfTwvZGl2PlxyXG4gICAgICAgICAgICAgIDxpIGNsYXNzPVwidXgtZGlhbG9nLS1sb2FkaW5nXCI+PC9pPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPGkgY2xhc3M9XCJ1eC1kaWFsb2ctLWRpbVwiPjwvaT5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIGA7XG4gICAgICAgIHJldHVybiBVeERpYWxvZy5odG1sVG9FbGVtZW50KGRpYWxvZyk7XG4gICAgfVxuICAgIHN0YXRpYyBodG1sVG9FbGVtZW50KHN0cikge1xuICAgICAgICBjb25zdCB0ZW1wbGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RlbXBsYXRlJyk7XG4gICAgICAgIHN0ciA9IHN0ci50cmltKCk7XG4gICAgICAgIHRlbXBsYXRlLmlubmVySFRNTCA9IHN0cjtcbiAgICAgICAgcmV0dXJuIHRlbXBsYXRlLmNvbnRlbnQuZmlyc3RDaGlsZDtcbiAgICB9XG4gICAgYXBwZW5kKGNvbnRlbnRzKSB7XG4gICAgICAgIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5ib2R5O1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSB0aGlzLm1ha2VOb2RlKGNvbnRlbnRzKTtcbiAgICAgICAgYm9keS5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnQpO1xuICAgIH1cbiAgICBnZXREZWZhdWx0Q29udGVudHMoY29udGVudHMpIHtcbiAgICAgICAgdGhpcy5jaGVja1R5cGUoY29udGVudHMpO1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSBudWxsO1xuICAgICAgICB0aGlzLmNvbnRlbnRzID0ge307XG4gICAgICAgIE9iamVjdC5lbnRyaWVzKGNvbnRlbnRzKS5tYXAoKHZhbCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5jb250ZW50c1t2YWxbMF1dID0gdmFsWzFdO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgYmluZEV2ZW50KGNvbnRlbnRzKSB7XG4gICAgICAgIHdpbmRvdy5vbmtleXVwID0gZSA9PiB7XG4gICAgICAgICAgICBpZiAoY29udGVudHMuY2xvc2VLZXkgPT09IGUua2V5Q29kZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY29udGVudHMuY2FuY2VsS2V5ID09PSBlLmtleUNvZGUpIHtcbiAgICAgICAgICAgICAgICAoY29udGVudHMuY2FuY2VsLmNhbGxiYWNrKSAmJiAoY29udGVudHMuY2FuY2VsLmNhbGxiYWNrKCkpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY29udGVudHMuY29uZmlybUtleSA9PT0gZS5rZXlDb2RlKSB7XG4gICAgICAgICAgICAgICAgKGNvbnRlbnRzLmNvbmZpcm0uY2FsbGJhY2spICYmIChjb250ZW50cy5jb25maXJtLmNhbGxiYWNrKCkpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy51eC1kaWFsb2ctLWNsb3NlJykub25jbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy51eC1kaWFsb2ctLWZvb3RlcicpLm9uY2xpY2sgPSAoZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbmFtZSA9IGUudGFyZ2V0Lm5hbWU7XG4gICAgICAgICAgICBzd2l0Y2ggKG5hbWUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdjb25maXJtJzpcbiAgICAgICAgICAgICAgICAgICAgKGNvbnRlbnRzLmNvbmZpcm0uY2FsbGJhY2spICYmIChjb250ZW50cy5jb25maXJtLmNhbGxiYWNrKCkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdjYW5jZWwnOlxuICAgICAgICAgICAgICAgICAgICAoY29udGVudHMuY2FuY2VsLmNhbGxiYWNrKSAmJiAoY29udGVudHMuY2FuY2VsLmNhbGxiYWNrKCkpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cbiAgICBvcGVuKGNvbnRlbnRzKSB7XG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnQgPT09IG51bGwpIHtcbiAgICAgICAgICAgIGxldCBvbmNlID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5jb250ZW50cyk7XG4gICAgICAgICAgICBpZiAoY29udGVudHMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrVHlwZShjb250ZW50cyk7XG4gICAgICAgICAgICAgICAgT2JqZWN0LmVudHJpZXMoY29udGVudHMpLm1hcCgodmFsKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGtleSA9IHZhbFswXTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSB2YWxbMV07XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbnRlbnRzW2tleV0gIT09IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvbmNlW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5hcHBlbmQob25jZSk7XG4gICAgICAgICAgICB0aGlzLmJpbmRFdmVudChvbmNlKTtcbiAgICAgICAgICAgIGlmIChvbmNlLnNlbGZDbG9zZSkge1xuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnN0byk7XG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy51eC1kaWFsb2ctLWxvYWRpbmcnKS5zdHlsZS5hbmltYXRpb25EdXJhdGlvbiA9IG9uY2Uuc2VsZkNsb3NlIC8gMTAwMCArICdzJztcbiAgICAgICAgICAgICAgICB0aGlzLnN0byA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgfSwgb25jZS5zZWxmQ2xvc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGNsb3NlKCkge1xuICAgICAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5lbGVtZW50O1xuICAgICAgICBpZiAoZWxlbWVudCkge1xuICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdjbG9zZScpO1xuICAgICAgICAgICAgZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcudXgtZGlhbG9nLS1kaW0nKS5hZGRFdmVudExpc3RlbmVyKCdhbmltYXRpb25lbmQnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5yZW1vdmUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50ID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgVXhEaWFsb2c7Il19
