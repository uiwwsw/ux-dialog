/*
 MIT License. 
 ux-dialog v0.1.7
 author: uiwwsw
 homepage:https://github.com/uiwwsw/ux-dialog#readme
 */ "use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var defaultText={confirm:"확인",cancel:"취소"},contentsType={confirm:"boolean",cancel:"boolean",title:"string",content:"string",callback:"function",text:"string",selfClose:"number",closeKey:"number",cancelKey:"number",confirmKey:"number"},UxDialog=function(){function c(e){_classCallCheck(this,c),this.getDefaultContents(e||{})}return _createClass(c,[{key:"checkType",value:function(e){var c=this;Object.entries(e).map(function(e){var t=e[0],n=e[1];if("object"===_typeof(n))c.checkType(n);else{var o=contentsType[t];if(_typeof(n)!==o)throw"".concat(n,"는 ").concat(o,"이 아닙니다.")}})}},{key:"makeNode",value:function(e){var t="",n="";e.confirm&&(t='<button name="confirm" type="button">'.concat(e.confirm.text||defaultText.confirm,"</button>")),e.cancel&&(n='<button name="cancel" type="button">'.concat(e.cancel.text||defaultText.cancel,"</button>"));var o='\n          <div class="ux-dialog">\n            <div class="ux-dialog--content">\n              <button type="button" class="ux-dialog--close">this dialog close</button>\n              <div class="ux-dialog--header">'.concat(e.title,'</div>\n              <div class="ux-dialog--container">').concat(e.content,'</div>\n              <div class="ux-dialog--footer">').concat(t).concat(n,'</div>\n              <i class="ux-dialog--loading"></i>\n            </div>\n            <i class="ux-dialog--dim"></i>\n          </div>\n        ');return c.htmlToElement(o)}},{key:"append",value:function(e){var t=document.body;this.element=this.makeNode(e),t.appendChild(this.element)}},{key:"getDefaultContents",value:function(e){var t=this;this.checkType(e),this.element=null,this.contents={},Object.entries(e).map(function(e){t.contents[e[0]]=e[1]})}},{key:"bindEvent",value:function(t){var n=this;window.onkeyup=function(e){if(t.closeKey!==e.keyCode)return t.cancelKey===e.keyCode?(t.cancel.callback&&t.cancel.callback(),void n.close()):void(t.confirmKey!==e.keyCode||t.confirm.callback&&t.confirm.callback());n.close()},this.element.querySelector(".ux-dialog--close").onclick=function(){n.close()},this.element.querySelector(".ux-dialog--footer").onclick=function(e){switch(e.target.name){case"confirm":t.confirm.callback&&t.confirm.callback();break;case"cancel":t.cancel.callback&&t.cancel.callback(),n.close()}}}},{key:"open",value:function(e){var o=this;if(null===this.element){var c=Object.assign({},this.contents);e&&(this.checkType(e),Object.entries(e).map(function(e){var t=e[0],n=e[1];o.contents[t]!==n&&(c[t]=n)})),this.append(c),this.bindEvent(c),c.selfClose&&(clearTimeout(this.sto),this.element.querySelector(".ux-dialog--loading").style.animationDuration=c.selfClose/1e3+"s",this.sto=setTimeout(function(){o.close()},c.selfClose))}}},{key:"close",value:function(){var e=this.element;e&&(e.classList.add("close"),e.querySelector(".ux-dialog--dim").addEventListener("animationend",function(){e.remove()}),this.element=null)}}],[{key:"htmlToElement",value:function(e){var t=document.createElement("template");return e=e.trim(),t.innerHTML=e,t.content.firstChild}}]),c}(),_default=UxDialog;exports.default=_default;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIiwidXgtZGlhbG9nLmJhc2UuanMiXSwibmFtZXMiOlsiZGVmYXVsdFRleHQiLCJjb25maXJtIiwiY2FuY2VsIiwiY29udGVudHNUeXBlIiwidGl0bGUiLCJjb250ZW50IiwiY2FsbGJhY2siLCJ0ZXh0Iiwic2VsZkNsb3NlIiwiY2xvc2VLZXkiLCJjYW5jZWxLZXkiLCJjb25maXJtS2V5IiwiVXhEaWFsb2ciLCJjb250ZW50cyIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJnZXREZWZhdWx0Q29udGVudHMiLCJvYmplY3QiLCJfdGhpcyIsIk9iamVjdCIsImVudHJpZXMiLCJtYXAiLCJ2YWwiLCJrZXkiLCJ2YWx1ZSIsIl90eXBlb2YiLCJjaGVja1R5cGUiLCJ0eXBlIiwiY29uY2F0IiwiZGlhbG9nIiwiaHRtbFRvRWxlbWVudCIsImJvZHkiLCJkb2N1bWVudCIsImVsZW1lbnQiLCJtYWtlTm9kZSIsImFwcGVuZENoaWxkIiwiX3RoaXMyIiwiX3RoaXMzIiwid2luZG93Iiwib25rZXl1cCIsImUiLCJrZXlDb2RlIiwiY2xvc2UiLCJxdWVyeVNlbGVjdG9yIiwib25jbGljayIsInRhcmdldCIsIm5hbWUiLCJfdGhpczQiLCJvbmNlIiwiYXNzaWduIiwiYXBwZW5kIiwiYmluZEV2ZW50IiwiY2xlYXJUaW1lb3V0Iiwic3RvIiwic3R5bGUiLCJhbmltYXRpb25EdXJhdGlvbiIsInNldFRpbWVvdXQiLCJjbGFzc0xpc3QiLCJhZGQiLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlIiwic3RyIiwidGVtcGxhdGUiLCJjcmVhdGVFbGVtZW50IiwidHJpbSIsImlubmVySFRNTCIsImZpcnN0Q2hpbGQiXSwibWFwcGluZ3MiOiI7Ozs7O3N0QkFnQkEsSUFBTUEsWUFBYyxDQUNoQkMsUUFBUyxLQUNUQyxPQUFRLE1BR05DLGFBQWUsQ0FDakJGLFFBQVMsVUFDVEMsT0FBUSxVQUNSRSxNQUFPLFNBQ1BDLFFBQVMsU0FDVEMsU0FBVSxXQUNWQyxLQUFN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SUFBTUcsV0FBVyxXQUNsQlQsRUFBS0wsU0FDTk0sRUFBS3hDLDZDQU1oQixJQUFNeUIsRUFBVWxCLEtBQUtrQixRQUNqQkEsSUFDQUEsRUFBUXdCLFVBQVVDLElBQUksU0FDdEJ6QixFQUFRVSxjQUFjLG1CQUFtQmdCLGlCQUFpQixlQUFnQixXQUN0RTFCLEVBQVEyQixXQUVaN0MsS0FBS2tCLFFBQVUsOENBeEZGNEIsR0FDakIsSUFBTUMsRUFBVzlCLFNBQVMrQixjQUFjLFlBR3hDLE9BRkFGLEVBQU1BLEVBQUlHLE9BQ1ZGLEVBQVNHLFVBQVlKLEVBQ2RDLEVBQVN6RCxRQUFRNkQsNkJDMkRqQnREIiwiZmlsZSI6InV4LWRpYWxvZy5tdmMubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW50ZXJmYWNlIEJ1dHRvbiB7XHJcbiAgICBjYWxsYmFjaz86IEZ1bmN0aW9uO1xyXG4gICAgdGV4dD86IHN0cmluZztcclxufVxyXG5cclxuaW50ZXJmYWNlIENvbnRlbnRzIHtcclxuICAgIHRpdGxlPzogc3RyaW5nO1xyXG4gICAgY29udGVudD86IHN0cmluZyB8IE5vZGU7XHJcbiAgICBjb25maXJtPzogQnV0dG9uIHwgbnVsbDtcclxuICAgIGNhbmNlbD86IEJ1dHRvbiB8IG51bGw7XHJcbiAgICBzZWxmQ2xvc2U/OiBudW1iZXI7XHJcbiAgICBjbG9zZUtleT86IG51bWJlcjtcclxuICAgIGNhbmNlbEtleT86IG51bWJlcjtcclxuICAgIGNvbmZpcm1LZXk/OiBudW1iZXI7XHJcbn1cclxuXHJcbmNvbnN0IGRlZmF1bHRUZXh0ID0ge1xyXG4gICAgY29uZmlybTogJ+2ZleyduCcsXHJcbiAgICBjYW5jZWw6ICfst6jshownXHJcbn07XHJcblxyXG5jb25zdCBjb250ZW50c1R5cGUgPSB7XHJcbiAgICBjb25maXJtOiAnYm9vbGVhbicsXHJcbiAgICBjYW5jZWw6ICdib29sZWFuJyxcclxuICAgIHRpdGxlOiAnc3RyaW5nJyxcclxuICAgIGNvbnRlbnQ6ICdzdHJpbmcnLFxyXG4gICAgY2FsbGJhY2s6ICdmdW5jdGlvbicsXHJcbiAgICB0ZXh0OiAnc3RyaW5nJyxcclxuICAgIHNlbGZDbG9zZTogJ251bWJlcicsXHJcbiAgICBjbG9zZUtleTogJ251bWJlcicsXHJcbiAgICBjYW5jZWxLZXk6ICdudW1iZXInLFxyXG4gICAgY29uZmlybUtleTogJ251bWJlcidcclxufTtcclxuXHJcbmNsYXNzIFV4RGlhbG9nIHtcclxuICAgIHByaXZhdGUgc3RvOiBhbnk7XHJcbiAgICBwcml2YXRlIGVsZW1lbnQ6IGFueTtcclxuICAgIHByaXZhdGUgY29udGVudHM6IENvbnRlbnRzO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGNvbnRlbnRzOiBDb250ZW50cykge1xyXG4gICAgICAgIHRoaXMuZ2V0RGVmYXVsdENvbnRlbnRzKGNvbnRlbnRzIHx8IHt9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNoZWNrVHlwZShvYmplY3Q6IG9iamVjdCk6IHZvaWQge1xyXG4gICAgICAgIE9iamVjdC5lbnRyaWVzKG9iamVjdCkubWFwKCh2YWwpID0+IHtcclxuICAgICAgICAgICAgY29uc3Qga2V5ID0gdmFsWzBdO1xyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHZhbFsxXTtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tUeXBlKHZhbHVlKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBjb250ZW50c1R5cGVba2V5XTtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09IHR5cGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBgJHt2YWx1ZX3ripQgJHt0eXBlfeydtCDslYTri5nri4jri6QuYFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBtYWtlTm9kZShjb250ZW50czogQ29udGVudHMpOiBhbnkge1xyXG4gICAgICAgIGxldCBjb25maXJtID0gJyc7XHJcbiAgICAgICAgbGV0IGNhbmNlbCA9ICcnO1xyXG4gICAgICAgIGlmIChjb250ZW50cy5jb25maXJtKSB7XHJcbiAgICAgICAgICAgIGNvbmZpcm0gPSBgPGJ1dHRvbiBuYW1lPVwiY29uZmlybVwiIHR5cGU9XCJidXR0b25cIj4ke2NvbnRlbnRzLmNvbmZpcm0udGV4dCB8fCBkZWZhdWx0VGV4dC5jb25maXJtfTwvYnV0dG9uPmBcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNvbnRlbnRzLmNhbmNlbCkge1xyXG4gICAgICAgICAgICBjYW5jZWwgPSBgPGJ1dHRvbiBuYW1lPVwiY2FuY2VsXCIgdHlwZT1cImJ1dHRvblwiPiR7Y29udGVudHMuY2FuY2VsLnRleHQgfHwgZGVmYXVsdFRleHQuY2FuY2VsfTwvYnV0dG9uPmBcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZGlhbG9nID0gYFxyXG4gICAgICAgICAgPGRpdiBjbGFzcz1cInV4LWRpYWxvZ1wiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwidXgtZGlhbG9nLS1jb250ZW50XCI+XHJcbiAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJ1eC1kaWFsb2ctLWNsb3NlXCI+dGhpcyBkaWFsb2cgY2xvc2U8L2J1dHRvbj5cclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidXgtZGlhbG9nLS1oZWFkZXJcIj4ke2NvbnRlbnRzLnRpdGxlfTwvZGl2PlxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ1eC1kaWFsb2ctLWNvbnRhaW5lclwiPiR7Y29udGVudHMuY29udGVudH08L2Rpdj5cclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidXgtZGlhbG9nLS1mb290ZXJcIj4ke2NvbmZpcm19JHtjYW5jZWx9PC9kaXY+XHJcbiAgICAgICAgICAgICAgPGkgY2xhc3M9XCJ1eC1kaWFsb2ctLWxvYWRpbmdcIj48L2k+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8aSBjbGFzcz1cInV4LWRpYWxvZy0tZGltXCI+PC9pPlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgYDtcclxuICAgICAgICByZXR1cm4gVXhEaWFsb2cuaHRtbFRvRWxlbWVudChkaWFsb2cpO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBodG1sVG9FbGVtZW50KHN0cjogc3RyaW5nKTogYW55IHtcclxuICAgICAgICBjb25zdCB0ZW1wbGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RlbXBsYXRlJyk7XHJcbiAgICAgICAgc3RyID0gc3RyLnRyaW0oKTtcclxuICAgICAgICB0ZW1wbGF0ZS5pbm5lckhUTUwgPSBzdHI7XHJcbiAgICAgICAgcmV0dXJuIHRlbXBsYXRlLmNvbnRlbnQuZmlyc3RDaGlsZDtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGFwcGVuZChjb250ZW50czogQ29udGVudHMpIHtcclxuICAgICAgICBjb25zdCBib2R5ID0gZG9jdW1lbnQuYm9keTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQgPSB0aGlzLm1ha2VOb2RlKGNvbnRlbnRzKTtcclxuICAgICAgICBib2R5LmFwcGVuZENoaWxkKHRoaXMuZWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXREZWZhdWx0Q29udGVudHMoY29udGVudHM6IENvbnRlbnRzKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5jaGVja1R5cGUoY29udGVudHMpO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jb250ZW50cyA9IHt9O1xyXG4gICAgICAgIE9iamVjdC5lbnRyaWVzKGNvbnRlbnRzKS5tYXAoKHZhbCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRzW3ZhbFswXV0gPSB2YWxbMV07XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBiaW5kRXZlbnQoY29udGVudHM/OiBDb250ZW50cykge1xyXG4gICAgICAgIHdpbmRvdy5vbmtleXVwID0gZSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChjb250ZW50cy5jbG9zZUtleSA9PT0gZS5rZXlDb2RlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGNvbnRlbnRzLmNhbmNlbEtleSA9PT0gZS5rZXlDb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAoY29udGVudHMuY2FuY2VsLmNhbGxiYWNrKSAmJiAoY29udGVudHMuY2FuY2VsLmNhbGxiYWNrKCkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjb250ZW50cy5jb25maXJtS2V5ID09PSBlLmtleUNvZGUpIHtcclxuICAgICAgICAgICAgICAgIChjb250ZW50cy5jb25maXJtLmNhbGxiYWNrKSAmJiAoY29udGVudHMuY29uZmlybS5jYWxsYmFjaygpKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy51eC1kaWFsb2ctLWNsb3NlJykub25jbGljayA9ICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy51eC1kaWFsb2ctLWZvb3RlcicpLm9uY2xpY2sgPSAoZSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBuYW1lID0gZS50YXJnZXQubmFtZTtcclxuICAgICAgICAgICAgc3dpdGNoIChuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdjb25maXJtJzpcclxuICAgICAgICAgICAgICAgICAgICAoY29udGVudHMuY29uZmlybS5jYWxsYmFjaykgJiYgKGNvbnRlbnRzLmNvbmZpcm0uY2FsbGJhY2soKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdjYW5jZWwnOlxyXG4gICAgICAgICAgICAgICAgICAgIChjb250ZW50cy5jYW5jZWwuY2FsbGJhY2spICYmIChjb250ZW50cy5jYW5jZWwuY2FsbGJhY2soKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBvcGVuKGNvbnRlbnRzPzogQ29udGVudHMpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5lbGVtZW50ID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGxldCBvbmNlOiBDb250ZW50cyA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuY29udGVudHMpO1xyXG4gICAgICAgICAgICBpZiAoY29udGVudHMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tUeXBlKGNvbnRlbnRzKTtcclxuICAgICAgICAgICAgICAgIE9iamVjdC5lbnRyaWVzKGNvbnRlbnRzKS5tYXAoKHZhbCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGtleSA9IHZhbFswXTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHZhbFsxXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jb250ZW50c1trZXldICE9PSB2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbmNlW2tleV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmFwcGVuZChvbmNlKTtcclxuICAgICAgICAgICAgdGhpcy5iaW5kRXZlbnQob25jZSk7XHJcblxyXG4gICAgICAgICAgICBpZiAob25jZS5zZWxmQ2xvc2UpIHtcclxuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnN0byk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignLnV4LWRpYWxvZy0tbG9hZGluZycpLnN0eWxlLmFuaW1hdGlvbkR1cmF0aW9uID0gb25jZS5zZWxmQ2xvc2UgLyAxMDAwICsgJ3MnO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdG8gPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICB9LCBvbmNlLnNlbGZDbG9zZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNsb3NlKCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLmVsZW1lbnQ7XHJcbiAgICAgICAgaWYgKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdjbG9zZScpO1xyXG4gICAgICAgICAgICBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy51eC1kaWFsb2ctLWRpbScpLmFkZEV2ZW50TGlzdGVuZXIoJ2FuaW1hdGlvbmVuZCcsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuIiwiY29uc3QgZGVmYXVsdFRleHQgPSB7XG4gICAgY29uZmlybTogJ+2ZleyduCcsXG4gICAgY2FuY2VsOiAn7Leo7IaMJ1xufTtcbmNvbnN0IGNvbnRlbnRzVHlwZSA9IHtcbiAgICBjb25maXJtOiAnYm9vbGVhbicsXG4gICAgY2FuY2VsOiAnYm9vbGVhbicsXG4gICAgdGl0bGU6ICdzdHJpbmcnLFxuICAgIGNvbnRlbnQ6ICdzdHJpbmcnLFxuICAgIGNhbGxiYWNrOiAnZnVuY3Rpb24nLFxuICAgIHRleHQ6ICdzdHJpbmcnLFxuICAgIHNlbGZDbG9zZTogJ251bWJlcicsXG4gICAgY2xvc2VLZXk6ICdudW1iZXInLFxuICAgIGNhbmNlbEtleTogJ251bWJlcicsXG4gICAgY29uZmlybUtleTogJ251bWJlcidcbn07XG5jbGFzcyBVeERpYWxvZyB7XG4gICAgY29uc3RydWN0b3IoY29udGVudHMpIHtcbiAgICAgICAgdGhpcy5nZXREZWZhdWx0Q29udGVudHMoY29udGVudHMgfHwge30pO1xuICAgIH1cbiAgICBjaGVja1R5cGUob2JqZWN0KSB7XG4gICAgICAgIE9iamVjdC5lbnRyaWVzKG9iamVjdCkubWFwKCh2YWwpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGtleSA9IHZhbFswXTtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gdmFsWzFdO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrVHlwZSh2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0eXBlID0gY29udGVudHNUeXBlW2tleV07XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gdHlwZSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBgJHt2YWx1ZX3ripQgJHt0eXBlfeydtCDslYTri5nri4jri6QuYDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBtYWtlTm9kZShjb250ZW50cykge1xuICAgICAgICBsZXQgY29uZmlybSA9ICcnO1xuICAgICAgICBsZXQgY2FuY2VsID0gJyc7XG4gICAgICAgIGlmIChjb250ZW50cy5jb25maXJtKSB7XG4gICAgICAgICAgICBjb25maXJtID0gYDxidXR0b24gbmFtZT1cImNvbmZpcm1cIiB0eXBlPVwiYnV0dG9uXCI+JHtjb250ZW50cy5jb25maXJtLnRleHQgfHwgZGVmYXVsdFRleHQuY29uZmlybX08L2J1dHRvbj5gO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb250ZW50cy5jYW5jZWwpIHtcbiAgICAgICAgICAgIGNhbmNlbCA9IGA8YnV0dG9uIG5hbWU9XCJjYW5jZWxcIiB0eXBlPVwiYnV0dG9uXCI+JHtjb250ZW50cy5jYW5jZWwudGV4dCB8fCBkZWZhdWx0VGV4dC5jYW5jZWx9PC9idXR0b24+YDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBkaWFsb2cgPSBgXHJcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwidXgtZGlhbG9nXCI+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ1eC1kaWFsb2ctLWNvbnRlbnRcIj5cclxuICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cInV4LWRpYWxvZy0tY2xvc2VcIj50aGlzIGRpYWxvZyBjbG9zZTwvYnV0dG9uPlxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ1eC1kaWFsb2ctLWhlYWRlclwiPiR7Y29udGVudHMudGl0bGV9PC9kaXY+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInV4LWRpYWxvZy0tY29udGFpbmVyXCI+JHtjb250ZW50cy5jb250ZW50fTwvZGl2PlxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ1eC1kaWFsb2ctLWZvb3RlclwiPiR7Y29uZmlybX0ke2NhbmNlbH08L2Rpdj5cclxuICAgICAgICAgICAgICA8aSBjbGFzcz1cInV4LWRpYWxvZy0tbG9hZGluZ1wiPjwvaT5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDxpIGNsYXNzPVwidXgtZGlhbG9nLS1kaW1cIj48L2k+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICBgO1xuICAgICAgICByZXR1cm4gVXhEaWFsb2cuaHRtbFRvRWxlbWVudChkaWFsb2cpO1xuICAgIH1cbiAgICBzdGF0aWMgaHRtbFRvRWxlbWVudChzdHIpIHtcbiAgICAgICAgY29uc3QgdGVtcGxhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZW1wbGF0ZScpO1xuICAgICAgICBzdHIgPSBzdHIudHJpbSgpO1xuICAgICAgICB0ZW1wbGF0ZS5pbm5lckhUTUwgPSBzdHI7XG4gICAgICAgIHJldHVybiB0ZW1wbGF0ZS5jb250ZW50LmZpcnN0Q2hpbGQ7XG4gICAgfVxuICAgIGFwcGVuZChjb250ZW50cykge1xuICAgICAgICBjb25zdCBib2R5ID0gZG9jdW1lbnQuYm9keTtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gdGhpcy5tYWtlTm9kZShjb250ZW50cyk7XG4gICAgICAgIGJvZHkuYXBwZW5kQ2hpbGQodGhpcy5lbGVtZW50KTtcbiAgICB9XG4gICAgZ2V0RGVmYXVsdENvbnRlbnRzKGNvbnRlbnRzKSB7XG4gICAgICAgIHRoaXMuY2hlY2tUeXBlKGNvbnRlbnRzKTtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gbnVsbDtcbiAgICAgICAgdGhpcy5jb250ZW50cyA9IHt9O1xuICAgICAgICBPYmplY3QuZW50cmllcyhjb250ZW50cykubWFwKCh2YWwpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY29udGVudHNbdmFsWzBdXSA9IHZhbFsxXTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGJpbmRFdmVudChjb250ZW50cykge1xuICAgICAgICB3aW5kb3cub25rZXl1cCA9IGUgPT4ge1xuICAgICAgICAgICAgaWYgKGNvbnRlbnRzLmNsb3NlS2V5ID09PSBlLmtleUNvZGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNvbnRlbnRzLmNhbmNlbEtleSA9PT0gZS5rZXlDb2RlKSB7XG4gICAgICAgICAgICAgICAgKGNvbnRlbnRzLmNhbmNlbC5jYWxsYmFjaykgJiYgKGNvbnRlbnRzLmNhbmNlbC5jYWxsYmFjaygpKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNvbnRlbnRzLmNvbmZpcm1LZXkgPT09IGUua2V5Q29kZSkge1xuICAgICAgICAgICAgICAgIChjb250ZW50cy5jb25maXJtLmNhbGxiYWNrKSAmJiAoY29udGVudHMuY29uZmlybS5jYWxsYmFjaygpKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcudXgtZGlhbG9nLS1jbG9zZScpLm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcudXgtZGlhbG9nLS1mb290ZXInKS5vbmNsaWNrID0gKGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBlLnRhcmdldC5uYW1lO1xuICAgICAgICAgICAgc3dpdGNoIChuYW1lKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnY29uZmlybSc6XG4gICAgICAgICAgICAgICAgICAgIChjb250ZW50cy5jb25maXJtLmNhbGxiYWNrKSAmJiAoY29udGVudHMuY29uZmlybS5jYWxsYmFjaygpKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnY2FuY2VsJzpcbiAgICAgICAgICAgICAgICAgICAgKGNvbnRlbnRzLmNhbmNlbC5jYWxsYmFjaykgJiYgKGNvbnRlbnRzLmNhbmNlbC5jYWxsYmFjaygpKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG4gICAgb3Blbihjb250ZW50cykge1xuICAgICAgICBpZiAodGhpcy5lbGVtZW50ID09PSBudWxsKSB7XG4gICAgICAgICAgICBsZXQgb25jZSA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuY29udGVudHMpO1xuICAgICAgICAgICAgaWYgKGNvbnRlbnRzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGVja1R5cGUoY29udGVudHMpO1xuICAgICAgICAgICAgICAgIE9iamVjdC5lbnRyaWVzKGNvbnRlbnRzKS5tYXAoKHZhbCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBrZXkgPSB2YWxbMF07XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gdmFsWzFdO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jb250ZW50c1trZXldICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb25jZVtrZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuYXBwZW5kKG9uY2UpO1xuICAgICAgICAgICAgdGhpcy5iaW5kRXZlbnQob25jZSk7XG4gICAgICAgICAgICBpZiAob25jZS5zZWxmQ2xvc2UpIHtcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5zdG8pO1xuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcudXgtZGlhbG9nLS1sb2FkaW5nJykuc3R5bGUuYW5pbWF0aW9uRHVyYXRpb24gPSBvbmNlLnNlbGZDbG9zZSAvIDEwMDAgKyAncyc7XG4gICAgICAgICAgICAgICAgdGhpcy5zdG8gPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIH0sIG9uY2Uuc2VsZkNsb3NlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IHRoaXMuZWxlbWVudDtcbiAgICAgICAgaWYgKGVsZW1lbnQpIHtcbiAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnY2xvc2UnKTtcbiAgICAgICAgICAgIGVsZW1lbnQucXVlcnlTZWxlY3RvcignLnV4LWRpYWxvZy0tZGltJykuYWRkRXZlbnRMaXN0ZW5lcignYW5pbWF0aW9uZW5kJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudCA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFV4RGlhbG9nOyJdfQ==
